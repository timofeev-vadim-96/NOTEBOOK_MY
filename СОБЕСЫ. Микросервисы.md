# Микросервисы

[Назад](./СОБЕСЫ.md)  

> Что такое микросервисная архитектура и в чем ее основные преимущества?

Микросервисная архитектура — это подход к разработке приложений, при котором крупные монолитные приложения разбиваются на маленькие автономные сервисы, каждый из которых выполняет определенную функцию и развивается независимо. 

Основные преимущества включают:
* Независимая разработка и деплоймент.
* Масштабируемость отдельных сервисов.
* Устойчивость к отказам (fault tolerance).
* Гибкость и адаптация к изменениям бизнеса.

> Что такое распределенная транзакция?

Это транзакции, которые охватывают несколько сетевых узлов или баз данных. Для этих целей может быть общей диспетчер транзакций (ждет сообщения от обеих БД о готовности к коммитам)

> Как гарантировать, что транзакция выполнится корректно в распределенной системе?

Использовать распределенные транзакции. Двухфазная фиксация (2PC) или использование более легких альтернатив, таких как саги (Sagas) или сообщения в очереди. Выбор зависит от требований к согласованности и производительности.

> Что такое service discovery и зачем оно нужно в микросервисах?

Service Discovery (обнаружение сервисов) — это механизм, который позволяет сервисам обнаруживать друг друга в распределенной среде. Сервисы регистрируются в реестре (например, Eureka или Consul), и другие сервисы могут найти их по имени. Это необходимо для обеспечения динамичности и масштабируемости в микросервисной архитектуре.

> Что такое Circuit Breaker и зачем он нужен в микросервисах?
Circuit Breaker — это паттерн, который предотвращает каскадные сбои в микросервисах. Если какой-то сервис начинает давать частые ошибки, circuit breaker временно изолирует его и возвращает заранее подготовленные ответы, чтобы не допустить перегрузку системы. В Java популярна библиотека Resilience4j для реализации этого паттерна.

> Какие бывают стратегии коммуникаций между микросервисами?
Существуют два основных подхода к коммуникации между микросервисами:

* Синхронная коммуникация: Обычно реализуется через HTTP/REST или gRPC. Сервисы напрямую общаются друг с другом, ожидая ответа.
* Асинхронная коммуникация: Осуществляется через брокеры сообщений (RabbitMQ, Kafka) или очередей (ActiveMQ). 
Микросервисы публикуют события, а другие подпишутся на них, реагируя на происходящее асинхронно.

> Как решается проблема межмикросервисной аутентификации и авторизации, с помощью каких подходов происходит аутентификация и авторизация между микросеврисами?

* JWT (JSON Web Tokens): Токены содержат информацию о пользователе и его правах, которые передаются между сервисами.
* OAuth2: Протокол авторизации, позволяющий получать токены доступа и проверять полномочия пользователя.
* API Gateway: Центральный пункт, через который проходят все запросы, отвечающий за проверку полномочий и аутентификацию.

> Для мониторинга и логирования микросервисов в Java часто используются:

* Prometheus с Grafana: Сбор метрик и визуализация статистики.
* ELK Stack (Elasticsearch, Logstash, Kibana): Логирование и анализ журналов.
* Zipkin/Sleuth: Распределенный трейсинг для отслеживания запросов между микросервисами.
* Actuator: Модуль Spring Boot для сбора метрик и здоровья приложения.

> Что такое API Gateway и зачем он нужен в микросервисной архитектуре?

API Gateway — это центральный компонент, через который проходят все внешние запросы к микросервисам. Он отвечает за маршрутизацию запросов, аутентификацию, авторизацию, защиту от атак, а также за подготовку и нормализацию данных для клиентов. API Gateway скрывает сложную внутреннюю структуру микросервисов, предоставляя единообразный интерфейс внешним клиентам.

> Как решаются проблемы консистентности данных в микросервисах?

* Eventual consistency (конечная консистенция): Данные становятся согласованными спустя некоторое время после совершения изменений.
* Событийно-ориентированная архитектура (Event-driven architecture): Микросервисы обмениваются событиями через брокеры сообщений (например, Kafka), обеспечивая распространение изменений.
* Компенсационные транзакции: При сбоях проводятся обратные операции для отмены неудачных изменений.

> Как осуществляется управление конфигурацией в микросервисной архитектуре?
Управление конфигурацией в микросервисах обычно централизовано с помощью специальных сервисов-конфигураций (например, Spring Cloud Config Server). Конфигурации хранятся в централизованном хранилище (Git, Vault и т.д.), откуда сервисы получают настройки во время запуска или динамически во время работы.

> Как решается проблема управления версиями API в микросервисах?

Есть несколько решений, но основное - версионирование API. /api/v1/..

> Как обеспечивается отказоустойчивость (resiliency) в микросервисах?

* Circuit Breaker Pattern: Быстрая изоляция неисправных сервисов (например, Resilience4j).
* Timeouts: Установка таймаутов для предотвращения длительного ожидания.
* Bulkhead Isolation: Разделение ресурсов (например, выделение отдельных потоков для разных сервисов).
* Fallback-стратегии: Предварительно подготовленные реакции на отказы сервисов.

> Что такое Service Mesh и для чего он используется?

* Service Mesh (Istio) — это специализированный слой инфраструктуры, который управляет коммуникацией между микросервисами в распределённой системе. Он отделяет управление трафиком, безопасность и наблюдение от самих приложений, позволяя разработчикам сосредоточиться на бизнес-логике, а не на низкоуровневой инфраструктурной логике.  
Именно на нем настраиваются Whitelists, egress/ingress соединения, а также с помощью него может происходить балансировка нагрузки.   