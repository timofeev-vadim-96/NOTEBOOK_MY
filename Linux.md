# LINUX

Преподаватель GB (Лекции) - Николай Лавлинский    
Преподаватель GB (Семинары) - Сергей Акопян (Яндекс Толока, Яндекс Алиса)

GNU/Linux - объективно, есть смысл использовать только в качестве серверной операционной системы  

Зачем вообще нужен Linux? - из-за тотального доминирования в серверном сегменте:  
● 100% TOP-500 суперкомпьютеров
● 95% самых популярных сайтов
● 90% облачной инфраструктуры
● Стандарт де-факто для
веб-приложений

Assembler - низкроуровневый машинный код  

`Системные вызовы в Linux:`      

● Управление процессами:
○ fork() – создание нового процесса клонированием
○ exec() – запуск программы
○ exit() – завершение программы

● Управление файлами:
○ open() – открыть файл //не имеет значение место хранения файла и его структура  
○ read() – прочитать данные из файла
○ write() – записать данные в файл
○ close() – закрыть файл

`Серверные и настольные системы:` //имеют общее ядро (основа OC) в Linux     

**Серверные (server) ОС**  //у пользователей нет доступа к серверам, за исключением администраторов  
● Платформа для сервисов (веб-сервер,
база данных…).
● Может не иметь графического
интерфейса.
● Имеют высокую стабильность.
● Работает 24/7  

**Настольные (desktop) ОС**  
● Платформа для приложений.
● Имеет графический интерфейс.
● Имеют высокую совместимость с
пользовательским ПО.

UNIX-подобные системы - начиная с 1970г. - движение открытого ПО (хотя изначально создавалось как коммерческий продукт)

Существует несколько диструбутивов Linux:  
1. (Debian (DEB) (DEB - формат упаковки пакетов)) (Debizn - название компании) - `Ubuntu`    
2. (Red hat (RPM)) - `Oracle Linux` 
3. Red hat - `CentOS` 
...

`Ubuntu`:  
1. Server  
1.1 LTS (выходят каждые 2 года) - long term support - гарантированная поддержка системы в течении 5 лет и более, обновление безопасности и свежих версий ПО     
1.2 no LTS (выходят каждые 6 мес) - поддержка порядка 9 мес. 
2. Desktop
2.1 LTS  
2.2 no LTS  

* Чтобы установить Linux OS поверх своей:  
Виртуализация в VirtualBox, например OracleVirtualBox  
● Межплатформенный продукт.
● Требуется поддержка аппаратной виртуализации в CPU.
● Широкие возможности по экспериментам
p.s. Для Mac M1,M2... (M)  не сработает  

Требования к железу для работы/установки VirtualBox:  
● RAM от 2048 MB
● Диск от 20 GB
● Загрузка с установочного ISO //образ оптического диска  

Для MacOS:  
1. https://mac.getutm.app/  - виртуальная машина  
1.1 Или вирт машина Parallels  
2. https://romankurnovskii.com/ru/posts/howto-install-ubuntu-desktop-on-arm/ алгоритм  

- **Для начала работы** необходимо скачать одну из виртуальных машин, затем скачать iso образ одного из дистребьютеров Linus, например, Ubuntu, и создать виртуальную машину с образом Linux.  
---

`Commands:`  
* sudo //запуск от имени администратора  
* sudo apt update //проверяет наличие актуальных версий приложений в пакетном менеджере на сервере  
  * sudo apt upgrade //устанавливает все эти обновления
* sudo apt install gcc make perl - перед началом работы в новой операционке (в виртуал боксе) //это название трех необходимых пакетов для дальнейшей работы (**гостевые пакеты**)
  * доп: sudo apt install tree  
* sudo apt install openssh-server //установка SSH-server 
* sudo ./VBoxLinuxAdditions.run // настройка модулей ядра операционной системы дляработы с Линукс Убунту, оптимизации декстом графики. Запускать, находясь в папке. Можно перейти через cd /media/vadim/...
  * Для этого необходимо смонтировать диск (iso): устройства -> подключить образ диска...
* sudo reboot //перезагрузка операционной системы
* ip a //мой ip
* watch -n 0.5 - выполняет следующую команду, которую написали с интервалом (-n) в 0,5 сек
  * watch -n 0.5 ip a //показывать ip и обновлять каждые 0.5 сек данные 
* mc // запуск миднайт коммандера  
добавить пользователя в качестве администратора:  
1. su
2. usermod -a -G wheel имя_пользователя  

* ls - показать содержимое текущей дерриктории  

* which ls - покажет в какой папке лежит бинарный файл команды ls  

* source .filename - обновить файл

* sudo passwd root - установить пароль к доступу к акк админа

* для того, чтобы добавить alias/алиасы (макросы/псевдонимы) - 91 строка .bashrc (файл в корневой папке)

* echo "hello" //эхо, выведится тоже самое
  * можно дозаписать куда-то: echo "Hello2" >> file/ перезаписать: echo "Hello" > file

`Commands for working with files`  //команды для работы с файлами

* ls - выводит содержимое текущей дерриктории
  * ls /etc/apt - если к конкретной папке
  * ls -l - вывод с толбик
  * ls -a - все файлы, в т.ч. скрытые
    * ls -la - в столбик
  * ls -A - тоже самое, но без текущего и родительского (точки)
    * ls -lA - в столбик
    * ls -lAh - тоже самое + вес отображается в К
    * ls -lAhi - тоже самое + i-nodes
* pwd - путь от корня до текущей дерриктории
* cd - для перемещения (без модификаторов - в домашнюю деррикторию)
  * пример: cd /etc/apt/
  * cd - //вернуться в папку, где мы были
* mkdir - создание дирректории
* cp - копирование
  * cp -r dir1/* dir2
* rm - удаление
  * для удаления каталогов: rm -r dir1 //-r значит рекурсивно
* mv - перемещение/переименование //перемещает 1 и более аргумент в последний аргумент. !!!Последний аргумент должен быть каталогом!!!
  * Пример для переименования: mv file1 file3
  * если при перемещении файл с таким именем уже существует в конечной дирректории, то он его заменит.
  * чтобы переместить все содержимое папки: mv dir1/*
* touch - изменяет время последнего доступа/изменения файла (по-простому: когда этот файл последний раз трогали)
  * если указать не существующий файл - создасться новый. Пример: touch file1
* touch ~/file1 // создать файл в домашней дирректории
* cat - вывести информацию, содержащуюся в файле: cat file1
  * перенаправить содержимое: cat file1 > file2, где > это перезаписать, а >> дозаписать
    * можно перенаправить с двух файлов: cat file1 file2 > file3
  * наполнить файл содержимым: cat > new_file; набираем текст; Ctrl + D
* tree - показать дерево с папками и файлами в текущей дерриктории
  * tree -L 1 // Уровень вложенности 1,2,3...

`Ссылки:`
* ln file hlink - жесткая ссылка //ссылается по inode, на конкретное место в памяти. Даже при удалении исходного файла
* ln -s file slink - мягкая ссылка//ссылается по пути (при переименовании исходного файла, потеряет его) //по факту как ярлык в винде

**Дальнейшая настройка**: 
1. Устройства - общий буфер обмена - двунаправленный  // для того, чтобы можно было копировать текст и переносить из одной ОС в другую.  
2. Устройства - общие папки - настройка общих папок. Добавляем папку Загрузки из основной операционной системы для возможности импорта файлов. 
Точка подключения - папка в виртуальной машине (в Ubuntu). Например: /home/vboxuser/windows_dir, где home - папка с домашними директорями всех пользователей, vboxuser - текущий пользователь  
3. Устройства - сеть - настроить сеть - Сетевой мост - для корректного отображения ip (новый - для нашей виртуальной машины, даже ролтер будет видеть как второе устройство) // по новому ip можно подключиться к серверу через ssh   
  * Чтобы подключиться к серверу Ubuntu из Windows:  
  ssh vboxuser@192.168.0.10 // где vboxuser - имя польз., после собаки - ip Unbuntu  
  * Чтобы отключиться в cmd(windows): exit/Ctrl+D 

* Сетевые режимы VitrualBox:  
● Мост (bridge) – ВМ в локальной сети, прямой доступ к ВМ по IP.  
● NAT – ВМ в своей сети, доступ к машине только через проброс портов.  


**Устанавливаем Миднайткомандер (midnight commander)** - Один из файловых менеджеров с текстовым интерфейсом: 
sudo apt install mc  
  * После установки - параметры -> убрать галку "Включить быструю клавишу доступа к меню", это для выхода через F10

**чтобы открыть терминал**: Ctrl + Alt + t

**проскролить до пустого экрана**: Ctrl + L  

**копирование и вставка**: Ctrl+Shaft+C и аналог.  

**Чтобы открыть справку по любой утилите, например apt**:  
sudo apt --help  / man apt - откроет мануал

**Сменить язык в терминале** - https://firstvds.ru/technology/kak-nastroit-podderzhku-russkogo-yazyka-v-terminale-linux  

---

## Оболочка (Bash) 

- слой(интерпретатор) для связи с ОС

**Приглашение оболочки**: db@linus-host:`$, где db - user, linux-host - comp. name/host name, wave - current catalog, $ - userTipe  

Структура папок в Ubuntu:  
* bin - бинарные файлы, утилиты  
  * usr/bin - бинарный файлы, предн. для user
* boot - информация для загрузки системы (загрузчик grab (для выбора ОС))
* dev - девайсы, все устройства
  * файл sda - главный жесткий диск (sda1, sda2 - разделы)
* etc - папка для конфигов (apt, ssh, ...)
  * ssh_config - конфиги для доступа куда-то
  * sshd_config - конфиги для доступа к нашему серверу
* home - домашние дирректории пользователей
  * bashrc - конфиги для оболочки (выделение текста, псевдонимы команд и т.д.) - вместо него может быть ssh (более новый вариант)
* media - для автоматического монтирования с помощью проводника
* mnt - для ручного монтирования
* lib 32/64 - с разл. библиотеками для приложений
* opt - файлы разл. приложений, которые мы ставили не через пакетный менеджер 
* proc - данные запущенных на данный момент процессов
  * /proc/cpuinfo — процессор
  * /proc/version — версия ОС
* root - домашняя дирректория суперпользователя
* run - дирректория, в кот. хранится инфа для запуска приложений
* sbin - бинарники, требующие разрешения суперпользователя для запуска
* snap - файлы пакетного менеджера snap
* srv - ?
* sys - системная информация
* tmp - временные файлы
* user - слепок папок для одного юзера
* var (variable) - изменяемые файлы
  * log - логи
* swapfile - файл подкачки - предназначен для хранения файлов, которые не поместились в оперативную память

`скрытый файл` - долджен начинаться с точки  

`Относительные и абсолютные пути:`  
● Абсолютные:  
○ начинаются с корня /  
○ всегда указывают на один и тот же объект  
○ cat /var/log/syslog  
● Относительные:  
○ не начинаются c /  
○ зависят от текущего положения  
○ cat test/testfile  
---

---

`Текстовые редакторы:`  
1. vim
2. nano
  * .nanorc - тип файла для работы
  * set linenumbers - нумерация строк
  * set softwrap - перенос построчный 
3. mcedit //не популярный

`Терминальные пейджеры:`  
head: head -n 3 .profile //вывести первые 3 строчки файла
tail: tail -n 3 .profile //вывести последние 3 строчки файла
more: more .profile // разворачивает содержимое файла, как свиток. При этом весь текст останется в терминале и засоряет его
less: less .profile //не засоряет терминал после выхода (чтобы выйти - q)
  * home - к началу
  * end - к концу
  * page up/down - перемещение полистно
  * стрелки - перемещение построчно